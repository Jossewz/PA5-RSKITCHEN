<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <title>Facturas</title>
  <style>
    /* Barra fija superior */
    nav {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 50px;
      background-color: #0059b3;
      display: flex;
      align-items: center;
      padding: 0 20px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.15);
      z-index: 1000;
    }

    nav a {
      color: white;
      text-decoration: none;
      font-weight: 600;
      margin-right: 20px;
      padding: 8px 12px;
      border-radius: 5px;
      transition: background-color 0.3s ease;
    }

    nav a:hover {
      background-color: #003d80;
    }

    body {
      padding-top: 60px; /* espacio para la barra fija */
      font-family: 'Poppins', sans-serif;
      background-color: #f0f4f8;
      color: #002244;
      margin: 0;
      padding-left: 20px;
      padding-right: 20px;
    }

    h1, h2 {
      text-align: center;
      color: #003366;
    }

    a:not(nav a) {
      color: #003366;
      text-decoration: none;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background-color: #ffffff;
      box-shadow: 0 4px 8px rgba(0, 51, 102, 0.1);
    }

    th, td {
      border: 1px solid #b3d1ff;
      padding: 10px;
      text-align: center;
    }

    th {
      background-color: #cce6ff;
      color: #002244;
    }

    tbody tr:nth-child(even) {
      background-color: #e6f0ff;
    }

    tbody tr:hover {
      background-color: #d0e3ff;
    }

    .detalle-factura {
      margin-top: 50px;
      border-top: 3px solid #004080;
      padding-top: 25px;
      background-color: #ffffff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0, 0, 102, 0.1);
    }

    .detalle-factura p {
      margin: 10px 0;
      font-size: 16px;
    }

    .total {
      font-weight: bold;
      font-size: 18px;
      text-align: right;
      margin-top: 15px;
      color: #003366;
    }

    button {
      background-color: #007acc;
      color: white;
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    button:hover {
      background-color: #005c99;
    }

    @media print {
      button, nav a {
        display: none;
      }

      body {
        background-color: white;
        color: black;
      }

      .detalle-factura {
        box-shadow: none;
        border: none;
      }
    }
  </style>
</head>
<body>

<nav>
  <a th:href="@{/home}">Rskitchen</a>
  <a th:href="@{/mesa}">Mesa</a>
  <a th:href="@{/mesero}">Mesero</a>
  <a th:href="@{/pedidos}">Pedido</a>
  <a th:href="@{/platillos}">Platillos</a>
  <a th:href="@{/factura}">Factura</a>
</nav>

<h1>Listado de Facturas</h1>
<table>
  <thead>
  <tr>
    <th>Mesa</th>
    <th>Mesero</th>
    <th>Fecha</th>
    <th>Total</th>
    <th>Acción</th>
  </tr>
  </thead>
  <tbody>
  <tr th:each="factura : ${facturas}">
    <td th:text="${factura.mesaNum}">Número de mesa</td>
    <td th:text="${factura.meseroName}">Nombre Mesero</td>
    <td th:text="${#temporals.format(factura.fecha, 'dd/MM/yyyy HH:mm')}">Fecha</td>
    <td th:text="${#numbers.formatDecimal(factura.total, 2, 'POINT', 0, 'COMMA')}">Total</td>
    <td>
      <a th:href="@{'/factura/' + ${factura.id}}">Ver detalle</a>
    </td>
  </tr>
  </tbody>
</table>

<div class="detalle-factura" th:if="${factura != null}">
  <h2>Factura Detalle</h2>
  <p><strong>Mesa:</strong> <span th:text="${factura.mesaNum}">Mesa</span></p>
  <p><strong>Mesero:</strong> <span th:text="${factura.meseroName}">Mesero</span></p>
  <p><strong>Fecha:</strong> <span th:text="${#temporals.format(factura.fecha, 'dd/MM/yyyy HH:mm')}">Fecha</span></p>

  <table>
    <thead>
    <tr>
      <th>Producto</th>
      <th>Cantidad</th>
      <th>Precio Unitario</th>
      <th>Subtotal</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="item : ${factura.items}">
      <td th:text="${item.name}">Producto</td>
      <td th:text="${item.unidades}">Cantidad</td>
      <td th:text="${#numbers.formatDecimal(item.price, 2, 'POINT', 0, 'COMMA')}">Precio</td>
      <td th:text="${#numbers.formatDecimal(item.price * item.unidades, 2, 'POINT', 0, 'COMMA')}">Subtotal</td>
    </tr>
    </tbody>
  </table>

  <p class="total">Total: <span th:text="${#numbers.formatDecimal(factura.total, 2, 'POINT', 0, 'COMMA')}">Total</span></p>

  <div style="margin-top: 20px; text-align: center;">
    <button onclick="window.print()">Imprimir o Guardar como PDF</button>
  </div>
</div>

</body>
</html>
